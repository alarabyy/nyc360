<div class="page-container" *ngIf="!isLoading" [style.--theme-color]="activeTheme?.color || '#333'">

  <header class="category-header">
    <div class="container text-center">
      <p class="top-meta">NYC360 EXPERIENCE</p>
      <h1 class="main-title">{{ activeTheme?.label || 'News' }}</h1>
      <p class="sub-meta">{{ dynamicDescription }}</p>
    </div>
  </header>

  <div class="container main-content">

    <section class="top-section mb-5">
      <div class="row g-4">
        <div class="col-lg-8" *ngIf="heroPost">
          <div class="hero-card">
            <img [src]="getImg(heroPost)" alt="Hero" [routerLink]="['/public/posts/details', heroPost.id]">
            <div class="hero-overlay">
              <span class="hero-cat-label">{{ activeTheme?.label }}</span>
              <h2>{{ heroPost.title }}</h2>
              <p class="d-none d-md-block">{{ heroPost.content | slice:0:150 }}...</p>
            </div>
          </div>
        </div>

        <div class="col-lg-4">
          <div class="top-side-list">
            <div class="section-header">
              <h3>Top {{ activeTheme?.label }}</h3>
              <a [routerLink]="['/public/feed', activeTheme?.path]" class="view-all">View All</a>
            </div>
            <hr class="colored-hr">

            <div class="side-item slide-in-right" *ngFor="let post of topSidePosts; let i = index"
              [style.animation-delay]="(i * 0.1) + 's'">
              <span class="cat-tag">{{ activeTheme?.label | uppercase }}</span>
              <h4 [title]="post.title" [routerLink]="['/public/posts/details', post.id]">{{ post.title | slice:0:70
                }}...</h4>
              <span class="time-ago">{{ post.createdAt | date:'shortTime' }} ago</span>
              <hr class="divider">
            </div>
          </div>
        </div>
      </div>
    </section>

    <section class="filter-bar-wrapper mb-5 fade-in-up">
      <div class="action-buttons">
        <button class="btn-pill white"><i class="bi bi-compass"></i> Explore Stories</button>
        <button class="btn-pill gray">My News</button>
      </div>
      <div class="post-action ms-auto d-none d-md-flex">
        <span class="lbl">Share Something?</span>
        <button class="btn-pill dark">+ post content</button>
      </div>
    </section>

    <section class="chips-scroll mb-5 fade-in-up" style="animation-delay: 0.1s;">
      <button class="chip active">All</button>
      <button class="chip">Trending</button>
      <button class="chip">Discussions</button>
      <button class="chip">Events</button>
      <div class="dropdown-filters ms-auto">
        <button class="chip-drop">Most Recent <i class="bi bi-chevron-down"></i></button>
      </div>
    </section>

    <section class="latest-grid-section mb-5 fade-in-up" style="animation-delay: 0.2s;" *ngIf="gridPosts.length > 0">
      <div class="section-header mb-3">
        <h3>Highlights</h3>
        <a [routerLink]="['/public/feed', activeTheme?.path]" class="view-all">View All</a>
      </div>
      <div class="row g-4">
        <div class="col-md-4" *ngFor="let post of gridPosts">
          <div class="grid-card">
            <div class="img-wrapper">
              <img [src]="getImg(post)" alt="Post Thumb" [routerLink]="['/public/posts/details', post.id]">
              <div class="color-bar"></div>
            </div>
            <div class="card-content">
              <h4 [routerLink]="['/public/posts/details', post.id]">{{ post.title | slice:0:60 }}...</h4>
              <p class="desc">{{ post.content | slice:0:100 }}...</p>
              <a [routerLink]="['/public/posts/details', post.id]" class="read-more">Read More <i
                  class="bi bi-arrow-right"></i></a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <div class="row g-5 mb-5 fade-in-up" style="animation-delay: 0.25s;">
      <div class="col-lg-8" *ngIf="moreNewsPosts.length > 0">
        <div class="section-header mb-4">
          <h3>More Stories</h3>
        </div>
        <div class="more-news-list">
          <div class="news-list-item mb-4" *ngFor="let post of moreNewsPosts">
            <div class="row g-3">
              <div class="col-4 col-sm-3">
                <div class="list-img">
                  <img [src]="getImg(post)" alt="thumb" [routerLink]="['/public/posts/details', post.id]">
                </div>
              </div>
              <div class="col-8 col-sm-9">
                <span class="cat-small">{{ activeTheme?.label }}</span>
                <h5 [routerLink]="['/public/posts/details', post.id]">{{ post.title }}</h5>
                <p class="desc d-none d-sm-block">{{ post.content | slice:0:120 }}...</p>
                <div class="meta">
                  <span>{{ post.author.name || post.author.username }}</span>
                  <span class="dot">•</span>
                  <span>{{ post.createdAt | date:'mediumDate' }}</span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <section class="text-only-section pt-5 border-top fade-in-up" style="animation-delay: 0.3s;"
      *ngIf="textOnlyPosts.length > 0">
      <div class="section-header mb-4 text-center">
        <h3>Community Discussions</h3>
        <p class="text-muted">Latest questions and posts from the community</p>
      </div>

      <div class="row g-4">
        <div class="col-md-6 col-lg-4" *ngFor="let post of textOnlyPosts">
          <div class="text-card-design" [routerLink]="['/public/posts/details', post.id]" style="cursor: pointer;">
            <div class="card-top-row">
              <span class="pill-tag">{{ activeTheme?.label }}</span>
              <span class="post-time">{{ post.createdAt | date:'shortTime' }} ago</span>
            </div>
            <h3 class="text-title">“{{ post.title }}”</h3>

            <div class="card-footer-meta">
              <img [src]="post.author.imageUrl || 'assets/user.png'" class="mini-avatar">
              <span>{{ post.author.username }}</span>
            </div>
          </div>
        </div>
      </div>
    </section>

  </div>
</div>